
// --- Source: js/data/actors.js ---

/**
 * actors.js
 * Contains the data for all cast and crew members.
 */
const actors = {
    'reza': {
        name: 'Ramtin Khorshidi',
        role: 'Reza',
        img: 'images/Actor Photos/Reza.jpg/DSC00177-1-min.jpg',
        bio: "Ramtin Khorshidi plays Reza, the eldest brother, in Foreign Homeland - a role that earned him Best Actor at the Vancouver International Youth Film Festival. He is a 22-year-old rapper and voice actor based in Calgary, known for his energetic performances and growing presence in the city's Iranian community. Ramtin has performed for crowds of 200-300 people and is now expanding into acting, with Foreign Homeland marking his first Canadian film project with Armin Productions. He's a collaborative artist who blends rap, pop, and traditional Iranian melodies to create his own unique sound. Fluent in Persian and Spanish, he writes and produces music in both languages. Ramtin is also beginning to build a career in advertising, showcasing his creativity across multiple fields."
    },
    'jamshid': {
        name: 'Mostafa Pouralamdari',
        role: 'Jamshid',
        img: 'images/Actor Photos/Jamshid.jpg/DSC00156-min.jpg',
        bio: 'Mostafa plays Jamshid, the father, in Foreign Homeland, marking his debut in a feature film. Mostafa is a Calgary-based actor and engineer with a lifelong love for theatre and film. Alongside earning two MSc degrees and building a career in engineering, he has acted in theatre, appeared in the short film The Taste of Brazilian Coffee, and narrated various projects. Since immigrating to Canada in 2011, he has continued creating and performing in his spare time.'
    },
    'ahmad': {
        name: 'Arash Minhas',
        role: 'Ahmad',
        img: 'images/Actor Photos/Ahmad.jpg/DSC00220_compressed.jpg',
        bio: "Arash plays Ahmad, the youngest brother, in Foreign Homeland. He is a Calgary-based interdisciplinary artist of Indo-Persian heritage, working across theatre, dance, and movement storytelling. He is currently completing a Master's degree in Interdisciplinary Creation and Research at the University of Calgary, focusing on themes of identity and selfhood among first-generation Indo-Persian immigrants. With over 15 years of experience, Arash has worked as a playwright, actor, dancer, and poet. His work blends personal narrative with cultural exploration, creating performances that connect tradition with contemporary expression."
    },
    'jim': {
        name: 'Rick Koy',
        role: 'Jim',
        img: 'images/Actor Photos/Jim.jpg/MV5BZTFmNjU0ZWEtNzM0Yi00MmI1LWI2OGItOWVlM2VjM2MxMTEyXkEyXkFqcGc@.jpg',
        bio: ''
    },
    'sara': {
        name: 'Zahra Masoumi',
        role: 'Sara',
        img: 'images/Actor Photos/Sara.jpg/DSC00188-min.jpg',
        bio: "Zahra Masoumi plays Sara, the sister, in Foreign Homeland. She has over six years of acting experience and is passionate about bringing characters to life and connecting with audiences. Acting allows her to step into different stories and explore humanity through performance. Her work spans both theatre and film. On stage, she has appeared in productions such as The Art, Lights Out, Absence, The Thirteen, The Crucible, and Don't Call Me Anymore, Mother! On screen, she starred as the lead role of Sara in Foreign Homeland, directed by Armin Zarringhalam."
    },
    'soheila': {
        name: 'Safura Naghavi',
        role: 'Soheila',
        img: 'images/Actor Photos/Soheila.jpg/DSC00132-min.jpg',
        bio: 'Safoura Naghavi played Soheila in Foreign Homeland, in the role of the Aunt. She is an experienced actor and voiceover artist with a solid background in theatre and film. After moving to Canada, she continued acting in both theatre and film, expanding her work through new collaborations. Safoura also has extensive experience in voiceover and dubbing, contributing to many productions in Iran and Canada. Fluent in Farsi and English, with basic Arabic, she is passionate about multicultural storytelling. Now based in Calgary, she remains dedicated to bringing meaningful characters to life and connecting with audiences through her craft.'
    },
    'susan': {
        name: 'Alexandra Scott',
        role: 'Susan Pike',
        img: 'images/Actor Photos/Susan.jpg/MV5BNzM5M2I3ZmItNDQyNS00ZDk0LThjOGUtODlhNjc4NGU2NDI2XkEyXkFqcGc@.jpg',
        bio: ''
    },
    'cameron': {
        name: 'Cameron Ross',
        role: 'Customer 2',
        img: 'images/Actor Photos/Cameron Ross - Customer 2/MV5BOGEyOTc0ZTQtNTliNS00N2NiLThiNzYtM2QxYTZlYmI4ODYzXkEyXkFqcGc@_compressed.jpg',
        bio: ''
    },
    'redi': {
        name: 'Redi Zyka',
        role: 'Customer 1',
        img: 'images/Actor Photos/Redi Zyka - Customer 1/-640-0-5ee52be4b0c1d.jpg',
        bio: ''
    },
    'armin': {
        name: 'Armin Zarringhalam',
        role: 'Producer, Director & Writer',
        img: 'images/Actor Photos/Cast and crew/Armin/DSC00081_compressed.jpg',
        bio: "Armin Zarringhalam is a 23-year-old Canadian-Iranian award-winning filmmaker from Calgary, Alberta. He earned his Bachelor of Commerce in Marketing from the Haskayne School of Business and discovered his passion for filmmaking at 17. As the founder of Armin Productions, he has directed and produced several projects, leading creative teams and developing short films. He also secured funding for his first feature film, Foreign Homeland, where he served as the executive producer, director, and writer. Armin's work is inspired by his dual heritage, and he aims to create meaningful stories that connect with diverse audiences. Completing his debut feature marks an important step in his growth as a filmmaker."
    },
    'sepidar': {
        name: 'Sepidar',
        role: 'Director of Photography',
        img: 'images/Actor Photos/Cast and crew/Sepidar/DSC00108_compressed.jpg',
        bio: "Meet Sepidar, our award-winning Director of Photography and editor for Foreign Homeland. With years of experience, she was the producers' clear choice for this project. Her cinematography brings emotion to life and leaves a powerful impact on every viewer. Passionate about film and women's representation, Sepidar's unique style shows in every shot. Her editing and attention to detail helped shape the film into what it is today. A true cornerstone of the team, she went above and beyond to make this project a success."
    },
    'romin': {
        name: 'Romin',
        role: 'Producer',
        img: 'images/Actor Photos/Cast and crew/Romin/DSC00048_compressed.jpg',
        bio: ''
    }
};


// --- Source: js/data/socials.js ---

/**
 * socials.js
 * Contains social media links for cast and crew.
 * Keys match the IDs used in actors.js and openModal calls.
 */
const socialLinks = {
    'reza': 'https://www.instagram.com/rami.momti?igsh=MWJ0angzazgzNGh5Nw==',       // Ramtin
    'sara': 'https://www.instagram.com/masoumi.zara?igsh=dnc5aTFnd2l3NDA5',         // Zahra
    'jamshid': 'https://www.instagram.com/mostafa.alamdri?igsh=b3U5N2FuMWhhcG1p',   // Mostafa
    'ahmad': 'https://www.instagram.com/arash.minhas?igsh=aWpvN2FuNTlhY3o5',        // Arash
    'soheila': 'https://www.instagram.com/safoura20?igsh=MTEyZTdzOHdrcHY4cQ==',     // Safoura
    'jim': 'https://www.instagram.com/rick.koy?igsh=MXd5cXdjMTMzY3A5ZQ==',          // Rick Koy
    'susan': 'https://www.instagram.com/firstlakegirl?igsh=MWxqYXN1dTFoMmhkdQ==',   // Alexandra Scott
    'cameron': 'https://www.instagram.com/cameron.ga.ross?igsh=YjBhZDFwYTBiMW5r',   // Cameron Ross
    'redi': 'https://www.instagram.com/redizyka?igsh=MTZhaDExNTJqZHhwdQ==',         // Redi Zyka
    'armin': 'https://www.instagram.com/armin.productions?igsh=c2pqbWs2NWZ5YWh2',   // Armin
    'sepidar': 'https://www.instagram.com/sepidar.artist?igsh=bm5ibm1odWV0aGV4',    // Sepidar
    'romin': 'https://www.instagram.com/amali_aspects?igsh=ZTE1b213OHoweG1q'        // Ramin/Romin
};


// --- Source: js/data/gallery.js ---

/**
 * gallery.js
 * Data file containing paths to gallery images.
 */
const galleryImages = [
    "images/Premiere Photos/_DSC8209-min.JPG",
    "images/Premiere Photos/_DSC8254-min.JPG",
    "images/Premiere Photos/_DSC8263-min.JPG",
    "images/Premiere Photos/_DSC8269-min.JPG",
    "images/Premiere Photos/_DSC8315-min.JPG",
    "images/Premiere Photos/_DSC8316-min.JPG"
];


// --- Source: js/data/awards.js ---

/**
 * awards.js
 * Centralized data for film awards and recognition.
 */

const awardsData = {
    'best-canadian-feature': {
        title: "Best Canadian Feature Award",
        subtitle: "Director: Armin Zarringhalam",
        festival: "Vancouver International Youth Film Festival",
        logo: "assets/awards/DCIFF LAUREL _ 2025-2026 New copy 2.png",
        image: "assets/awards/best_canadian_feature.jpg",
        quote: "Congratulations to Armin Zarringhalam for winning the Best Canadian Feature Award at the Vancouver International Youth Film Festival! A testament to his vision and the strength of this powerful story.",
        imageAlt: "Armin Zarringhalam Receiving Best Canadian Feature Award"
    },
    'best-actor': {
        title: "Best Actor Award",
        subtitle: "Ramtin Khorshidi",
        festival: "Vancouver International Youth Film Festival",
        logo: "assets/awards/BEST_ACTOR_Vancouver_International_Youth_Film_Festival_2025_1.png",
        image: "assets/awards/best_actor_moment.jpg",
        quote: "Congratulations to Ramtin Khorshidi for winning the Best Actor Award at the Vancouver International Youth Film Festival for his unforgettable performance in Foreign Homeland! His portrayal of a father's struggle and resilience touched hearts and earned well-deserved recognition.",
        imageAlt: "Ramtin Khorshidi Receiving Best Actor Award"
    }
};


// --- Source: js/modules/theme.js ---

/**
 * theme.js
 * Handles light/dark mode switching and persistence.
 */

function initTheme() {
    const themeToggle = document.getElementById('theme-toggle');
    if (!themeToggle) return;

    // Check for saved theme in localStorage
    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

    // Set initial theme
    if (savedTheme === 'light') {
        document.body.classList.add('light-mode');
    } else if (savedTheme === 'dark') {
        document.body.classList.remove('light-mode');
    } else if (!systemPrefersDark) {
        // If no saved preference, default to system preference
        document.body.classList.add('light-mode');
    }

    // Add click listener
    themeToggle.addEventListener('click', toggleTheme);
}

function toggleTheme() {
    const isLightMode = document.body.classList.toggle('light-mode');

    // Save preference
    localStorage.setItem('theme', isLightMode ? 'light' : 'dark');

    // Smooth transition for color changes
    document.body.style.transition = 'background-color 0.3s ease, color 0.3s ease';
}


// --- Source: js/modules/carousel.js ---

/**
 * carousel.js
 * Handles the auto-playing background carousel for the Premiere section.
 */

let slideIntervalId;
const slideIntervalTime = 6000; // 6 seconds

function startCarousel() {
    if (slideIntervalId) return; // Already running

    const slides = document.querySelectorAll('.premiere-slide');
    if (slides.length === 0) return;

    slideIntervalId = setInterval(() => {
        // Find visible active slide to determine where we are
        // We track state via DOM classes for simplicity here, though variable state is better
        // Let's stick to the original logic's intent but robustify
        let activeIndex = Array.from(slides).findIndex(s => s.classList.contains('active'));
        if (activeIndex === -1) activeIndex = 0;

        slides[activeIndex].classList.remove('active');

        const nextIndex = (activeIndex + 1) % slides.length;
        slides[nextIndex].classList.add('active');

    }, slideIntervalTime);
}

function stopCarousel() {
    if (slideIntervalId) {
        clearInterval(slideIntervalId);
        slideIntervalId = null;
    }
}

function initCarousel() {
    const slides = document.querySelectorAll('.premiere-slide');
    if (slides.length > 0) {
        // Use Intersection Observer to only play when visible
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Only start if not paused manually by gallery (we'll check a flag or just let gallery control it)
                    // The gallery modal logic explicitly calls stop(), so when gallery closes it calls start().
                    // But if we scroll away, we should stop.
                    // If gallery is open, we shouldn't start. 
                    const galleryModal = document.getElementById('gallery-modal');
                    if (galleryModal.style.display !== 'flex') {
                        startCarousel();
                    }
                } else {
                    stopCarousel();
                }
            });
        }, { threshold: 0.1 });

        const gallery = document.querySelector('.gallery');
        if (gallery) {
            observer.observe(gallery);
        } else {
            startCarousel();
        }
    }

    // Expose to window for gallery to use if needed, but gallery module imports these directly
    // so we don't need window.galleryCarousel anymore if we wire modules correctly.
}


// --- Source: js/modules/modals.js ---

/**
 * modals.js
 * Unified modal management for actor biographies and award details.
 */

/**
 * Opens a modal for a specific cast/crew member.
 * @param {string} actorKey - The ID of the actor in js/data/actors.js
 */
function openModal(actorKey) {
    const modal = document.getElementById('actor-modal');
    const modalImg = document.getElementById('modal-img');
    const modalName = document.getElementById('modal-name');
    const modalRole = document.getElementById('modal-role');
    const modalBio = document.getElementById('modal-bio');
    const modalText = document.querySelector('.modal-text');

    const actor = actors[actorKey];
    if (actor) {
        modalImg.src = actor.img;
        modalName.textContent = actor.name;
        modalRole.textContent = actor.role;
        modalBio.textContent = actor.bio;

        // Remove existing social button if any
        const existingBtn = modalText.querySelector('.modal-social-btn');
        if (existingBtn) {
            existingBtn.remove();
        }

        // Add social link if exists
        const socialUrl = socialLinks[actorKey];
        if (socialUrl) {
            const socialBtn = document.createElement('a');
            socialBtn.href = socialUrl;
            socialBtn.target = '_blank';
            socialBtn.className = 'modal-social-btn';
            socialBtn.innerHTML = `
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                    <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                    <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                </svg>
                <span>Follow on Instagram</span>
            `;
            modalText.appendChild(socialBtn);
        }

        modal.style.display = 'block';
        document.body.style.overflow = 'hidden'; // Prevent scrolling
    }
}

/**
 * Closes the actor modal and re-enables body scrolling.
 */
function closeModal() {
    const modal = document.getElementById('actor-modal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto'; // Enable scrolling
}

// Award Modal
/**
 * Opens the award modal with specific award data.
 * @param {string} awardKey - The key in awardsData (from js/data/awards.js)
 */
function openAwardModal(awardKey) {
    const modal = document.getElementById('award-modal');
    const awardImg = document.getElementById('award-img');
    const awardLogo = modal.querySelector('.award-logo-small');
    const awardTitle = modal.querySelector('h2');
    const awardSubtitle = modal.querySelector('h3');
    const awardFestival = modal.querySelector('h4');
    const awardQuote = modal.querySelector('blockquote p');

    const data = awardsData[awardKey];
    if (data) {
        awardImg.src = data.image;
        awardImg.alt = data.imageAlt;
        awardLogo.src = data.logo;
        awardTitle.textContent = data.title;
        awardSubtitle.textContent = data.subtitle;
        awardFestival.textContent = data.festival;
        awardQuote.innerHTML = `"${data.quote}"`;

        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
}

/**
 * Closes the award modal and re-enables body scrolling.
 */
function closeAwardModal() {
    const modal = document.getElementById('award-modal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
}


/**
 * Initializes global click listeners to close modals when clicking outside them.
 */
function initModalListeners() {
    window.onclick = function (event) {
        const actorModal = document.getElementById('actor-modal');
        const awardModal = document.getElementById('award-modal');
        if (event.target == actorModal) {
            closeModal();
        }
        if (event.target == awardModal) {
            closeAwardModal();
        }
    };
}


// --- Source: js/modules/gallery.js ---

/**
 * gallery.js
 * Handles the manual interaction for the Premiere Photo Gallery Modal.
 * Dependencies: js/data/gallery.js, js/modules/carousel.js (stopCarousel, startCarousel)
 */

let currentGalleryIndex = 0;

/**
 * Opens the gallery modal, stops the main page carousel, 
 * and initializes thumbnails if they don't exist.
 */
function openGalleryModal() {
    const modal = document.getElementById('gallery-modal');
    const thumbsContainer = document.getElementById('gallery-thumbnails');

    // Stop the auto-carousel on main page
    stopCarousel();

    // Reset to first image
    currentGalleryIndex = 0;
    updateGalleryView();

    // Generate thumbnails if empty
    if (thumbsContainer.querySelectorAll('.gallery-thumb').length === 0) {
        galleryImages.forEach((src, index) => {
            const thumb = document.createElement('img');
            thumb.src = src;
            thumb.className = 'gallery-thumb';
            thumb.alt = `Thumbnail ${index + 1}`;
            thumb.onclick = () => {
                currentGalleryIndex = index;
                updateGalleryView();
            };
            thumbsContainer.appendChild(thumb);
        });
    }

    modal.style.display = 'flex'; // Use flex for centering
    document.body.style.overflow = 'hidden';
}

/**
 * Closes the gallery modal and resumes the main page carousel.
 */
function closeGalleryModal() {
    const modal = document.getElementById('gallery-modal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';

    // Resume auto-carousel
    startCarousel();
}

/**
 * Changes the currently displayed image by a given direction.
 * @param {number} direction - The number of steps to move (e.g., 1 for next, -1 for prev).
 */
function changeGalleryImage(direction) {
    currentGalleryIndex += direction;
    if (currentGalleryIndex >= galleryImages.length) currentGalleryIndex = 0;
    if (currentGalleryIndex < 0) currentGalleryIndex = galleryImages.length - 1;
    updateGalleryView();
}

/**
 * Updates the main image and active thumbnail highlight based on currentGalleryIndex.
 */
function updateGalleryView() {
    const mainImg = document.getElementById('gallery-main-img');
    const thumbs = document.querySelectorAll('.gallery-thumb');

    mainImg.src = galleryImages[currentGalleryIndex];

    thumbs.forEach((thumb, index) => {
        if (index === currentGalleryIndex) {
            thumb.classList.add('active');
            thumb.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        } else {
            thumb.classList.remove('active');
        }
    });
}

/**
 * Initializes click and keyboard listeners for gallery navigation.
 */
function initGalleryListeners() {
    const prevBtn = document.getElementById('gallery-prev');
    const nextBtn = document.getElementById('gallery-next');

    if (prevBtn) {
        prevBtn.onclick = () => changeGalleryImage(-1);
    }
    if (nextBtn) {
        nextBtn.onclick = () => changeGalleryImage(1);
    }

    window.addEventListener('click', function (event) {
        const galleryModal = document.getElementById('gallery-modal');
        if (event.target == galleryModal) {
            closeGalleryModal();
        }
    });

    // Keyboard navigation
    window.addEventListener('keydown', function (event) {
        const galleryModal = document.getElementById('gallery-modal');
        if (galleryModal.style.display === 'flex') {
            if (event.key === 'ArrowLeft') changeGalleryImage(-1);
            if (event.key === 'ArrowRight') changeGalleryImage(1);
            if (event.key === 'Escape') closeGalleryModal();
        }
    });
}


// --- Source: js/modules/ui.js ---

/**
 * ui.js
 * Handles general UI animations and enhancements.
 */

function initTitleAnimation() {
    const title = document.querySelector('.film-title');
    if (!title) return;

    const text = title.textContent.trim();
    title.innerHTML = '';

    // Split text into words first
    const words = text.split(' ');

    words.forEach((word, index) => {
        const wordSpan = document.createElement('span');
        wordSpan.className = 'word';

        // Split word into characters
        word.split('').forEach(char => {
            const charSpan = document.createElement('span');
            charSpan.textContent = char;
            charSpan.className = 'char-animate';
            wordSpan.appendChild(charSpan);
        });

        title.appendChild(wordSpan);

        // Add spacer between words, but not after the last word
        if (index < words.length - 1) {
            const spacer = document.createElement('span');
            spacer.innerHTML = '&nbsp;';
            spacer.className = 'spacer';
            title.appendChild(spacer);
        }
    });
}

function initButtonAnimation() {
    const button = document.querySelector('.cta-button');
    if (button) {
        button.addEventListener('animationend', () => {
            const text = button.querySelector('.text');
            if (text) {
                text.style.animation = 'none';
                setTimeout(() => {
                    text.style.animation = '';
                }, 10);
            }
        });
    }
}



// --- Source: js/main.js ---

/**
 * main.js
 * Main entry point for the application.
 * Initializes global event listeners.
 */

// Initialize Logic on Load
document.addEventListener('DOMContentLoaded', function () {
    initTheme();
    initCarousel();
    initModalListeners();
    initGalleryListeners();
    initTitleAnimation();
    initButtonAnimation();

    // Attach functions to window for HTML inline event handlers
    // This allows onclick="openModal('id')" to work even with modules
    window.openModal = openModal;
    window.closeModal = closeModal;
    window.openAwardModal = openAwardModal;
    window.closeAwardModal = closeAwardModal;

    window.openGalleryModal = openGalleryModal;
    window.closeGalleryModal = closeGalleryModal;
    window.changeGalleryImage = changeGalleryImage;
});

